import{r as n,h as $,f as V,j as e,F as G,b as k,s as H}from"./index-B_HkDvX-.js";import{i as F,a as v,g as q,b as J,c as K}from"./appFunctions-D5LvzQzQ.js";import{U as B}from"./userTypeHook-DW0xPVE0.js";import{u as W,a as X,b as Z,c as ee,O as Q,S as _}from"./OrderStatusComponent-f5zr7DLd.js";import{F as I}from"./appInterfaces-C6HlsS5g.js";import{u as se,a as ae}from"./branchesEndPoint-CCCld7yW.js";import{F as Y,d as te,e as le}from"./index-CcnOB6WK.js";import{A as ie}from"./loader-DtwxB0VL.js";import{T as ne,P as ce,A as re}from"./AppDeleteModal-CCWxsZ68.js";const de=({perPage:g,page:d})=>{const[i,{data:c,isLoading:f,error:N}]=W(),[y,{data:A,isLoading:l,error:O}]=X(),[b,T]=n.useState(null),[m,S]=n.useState(null),[o,u]=n.useState(null),x=$(p=>{var j;return(j=p==null?void 0:p.userInfoSlice)==null?void 0:j.userInfo}),h=B(),E=n.useCallback(()=>{h===I.FRANCHISE&&y({params:{franchiseId:x==null?void 0:x.id,perPage:g,page:d}}),h===I.ADMIN&&i({params:{perPage:g,page:d}})},[h,d]);return n.useEffect(()=>{E()},[h,d]),n.useEffect(()=>{T(f),S(c),u(N)},[c,,f,N]),n.useEffect(()=>{T(l),S(A),u(O)},[A,,l,O]),{isLoading:b,data:m,isError:o}},Ne=({perPage:g,isPagination:d})=>{var j;const i=B(),{data:c}=se({params:{perPage:"",page:""}}),[f]=Z(),[N]=ee(),[y,A]=n.useState(1),{data:l,isLoading:O,isError:b}=de({perPage:g,page:y}),[T,{data:m}]=ae(),S=V(),o=$(s=>{var t;return(t=s==null?void 0:s.userInfoSlice)==null?void 0:t.userInfo}),u=n.useRef(),x=(s,t)=>{console.log("deleteModalData.current",t)},h=async s=>{try{const t=await f(s);t!=null&&t.data&&H("Order transfered succesfully")}catch(t){console.log("e",t)}},E=async s=>{try{const t=await N(s);console.log("assignOrderToDeliveryAgent",t,s),t!=null&&t.data&&H("Order Assigned succesfully")}catch(t){console.log("e",t)}},p=s=>{S(`/orders/orderDetails/${s}`)};return n.useEffect(()=>{i===I.FRANCHISE&&T({params:{franchiseId:o==null?void 0:o.id,userType:I.DELIVERYAGENTS}})},[i,y]),e.jsxs(e.Fragment,{children:[e.jsxs(ne,{hover:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("p",{className:"tableTitle",children:"#"})}),e.jsx("th",{children:e.jsx("p",{className:"tableTitle",children:"Order"})}),e.jsx("th",{children:e.jsx("p",{className:"tableTitle",children:"Date"})}),e.jsx("th",{children:e.jsx("p",{className:"tableTitle",children:"Customer Name"})}),e.jsx("th",{children:e.jsx("p",{className:"tableTitle",children:"Order Status"})}),e.jsx("th",{children:e.jsx("p",{className:"tableTitle",children:"Payment Status"})}),e.jsx("th",{children:e.jsx("p",{className:"tableTitle",children:"Phone"})}),e.jsx("th",{children:e.jsx("p",{className:"tableTitle",children:"Address"})}),F(i)&&e.jsx("th",{children:e.jsx("p",{className:"tableTitle",children:"Transfer"})}),v(i)&&e.jsx("th",{children:e.jsx("p",{className:"tableTitle",children:"Assign To"})}),e.jsx("th",{children:e.jsx("p",{className:"tableTitle",children:"Actions"})})]})}),e.jsx("tbody",{children:l&&(l==null?void 0:l.orders.map((s,t)=>{var L,C,D,w,P,M,R,U,z;return e.jsxs("tr",{className:"appRow",children:[e.jsx("td",{className:"tableItem ",children:t+1}),e.jsx("td",{className:"tableItem curserPointer",onClick:()=>{p(s==null?void 0:s.id)},children:e.jsx("p",{className:"Orderpage-id text-uppercase",children:`#${q(s==null?void 0:s.id)}`})}),e.jsxs("td",{className:"tableItem text-nowrap",children:[J(s==null?void 0:s.date)," "]}),e.jsx("td",{className:"tableItem text-capitalize",children:((L=s.userId)==null?void 0:L.name)||"---"}),e.jsx("td",{className:"tableItem text-capitalize",children:e.jsx(Q,{label:s==null?void 0:s.orderStatus,status:s==null?void 0:s.orderStatus,type:_.Order})}),e.jsx("td",{className:"tableItem text-capitalize",children:e.jsx(Q,{label:(C=s==null?void 0:s.paymentStatus)==null?void 0:C.toLocaleLowerCase(),status:s==null?void 0:s.paymentStatus,type:_.Payment})}),e.jsx("td",{className:"tableItem",children:((D=s==null?void 0:s.userId)==null?void 0:D.primaryNumber)||"---"}),e.jsxs("td",{className:"tableItem",children:[(P=(w=s==null?void 0:s.userId)==null?void 0:w.primaryAddress)==null?void 0:P.name,", ",(R=(M=s==null?void 0:s.userId)==null?void 0:M.primaryAddress)==null?void 0:R.houseNo,", ",(z=(U=s==null?void 0:s.userId)==null?void 0:U.primaryAddress)==null?void 0:z.streetName]}),F(i)&&e.jsx("td",{className:"tableItem",children:e.jsxs(G.Select,{"aria-label":"Order Transfer",onChange:a=>{var r;h({id:s.id,franchiseId:(r=a==null?void 0:a.target)==null?void 0:r.value})},children:[e.jsx("option",{children:"Select Franchise"}),(c==null?void 0:c.franchises)&&(c==null?void 0:c.franchises.map(a=>{var r;return e.jsx("option",{value:a._id,selected:((r=s==null?void 0:s.franchiseId)==null?void 0:r.id)===a._id,children:a==null?void 0:a.name},a._id)}))]})}),v(i)&&e.jsx("th",{className:"tableItem",children:e.jsxs(G.Select,{"aria-label":"Order Transfer",onChange:a=>{var r;E({id:s.id,deliveryAgentId:(r=a==null?void 0:a.target)==null?void 0:r.value})},children:[e.jsx("option",{children:"Select Agent"}),m&&(m==null?void 0:m.map(a=>e.jsx("option",{value:a.id,selected:(s==null?void 0:s.deliveryAgentId)===a.id,children:a==null?void 0:a.name},a.id)))]})}),e.jsxs("td",{className:"text-nowrap align-middle",children:[(F(i)||v(i))&&e.jsxs(e.Fragment,{children:[e.jsx(Y,{icon:te,className:"Orderpage-actions Orderpage-eye",onClick:()=>{p(s==null?void 0:s.id)}}),e.jsx(Y,{icon:le,className:"Orderpage-actions deleteIcon",onClick:()=>{var a;(a=u.current)==null||a.open(s)}})," "]}),K(i)&&e.jsxs(e.Fragment,{children:[e.jsx(k,{variant:"outline-primary",className:"elementSpace",children:"Accept"}),e.jsx(k,{variant:"outline-secondary",children:"Cancel"})]})]})]},s==null?void 0:s.id)}))})]}),b&&e.jsx("div",{className:"emptyTable",children:e.jsx("p",{children:"Something went wrong!"})}),O&&e.jsx("div",{className:"emptyTable",children:e.jsx(ie,{})}),((j=l==null?void 0:l.orders)==null?void 0:j.length)===0&&e.jsx("div",{className:"emptyTable",children:"No Data Found"}),(l==null?void 0:l.totalOrders)>10&&d&&e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx(ce,{count:l.totalPages,shape:"rounded",onChange:(s,t)=>{A(t)}})}),e.jsx(re,{ref:u,title:"Do you want to delete this Order?",accept:x})]})};export{Ne as A,de as u};
