import{v as W,p as O,e as R,w as _,r as o,j as e,F as s,C as n,b as y,k as v,A as S,s as p}from"./index-Zq6-1N3V.js";import{C as L}from"./Card-DfUjdIBO.js";import{R as g}from"./Row-BlQ2K1mW.js";import{F as K,l as $}from"./index-DuoEw2RD.js";import{a as G,b as Q,c as Y}from"./InventoryEndPoint-B4HfRJPa.js";import{I as z}from"./Image--8sUJAE3.js";const N=(l,d)=>{switch(console.log("controller, getErrorMessage",l,d),d){case"required":return`${l} is required`;case"pattern":return"Please enter valid data";default:return""}},H=l=>new Promise((d,c)=>{const t=new FormData;t.append("file",l),t.append("upload_preset","cgvymfjn"),t.append("cloud_name","dnhbdmhp6"),fetch(`${W.FILEUPLOADURL}`,{method:"POST",body:t}).then(a=>a.json()).then(a=>{d(a.secure_url)}).catch(a=>{c("An Error Occured While Uploading")})}),ae=()=>{const{register:l,handleSubmit:d,reset:c,formState:{defaultValues:t,errors:a}}=O({}),[C,{isLoading:E}]=G(),[w,{isError:U,isLoading:P}]=Q(),[F,{isError:k,isLoading:A,data:B}]=Y(),x=R(),{id:m}=_(),u=o.useRef(null),[b,q]=o.useState(null),[j,I]=o.useState("https://as2.ftcdn.net/v2/jpg/02/41/38/73/1000_F_241387314_Sr3d8fVbXw0tWHQvZlKvbwY5YnEDC91V.jpg"),D=()=>{var i;u!=null&&u.current&&((i=u.current)==null||i.click())},M=i=>{i.target.files&&i.target.files[0]&&(I(URL.createObjectURL(i.target.files[0])),q(i.target.files[0]),u.current.target.files="")},T=async i=>{try{let h="";b&&(h=await H(b));const r=Object.assign(i,{createdBy:v(S.userId),updatedBy:v(S.userId),imageUrl:h||j,globalItemStatus:!!(t!=null&&t.globalItemStatus)});if(m){await w(r),p("Item Updated Succesfully"),x("/inventory");return}const f=await C(r);f!=null&&f.data&&(p("Item Added Succesfully"),x("/inventory"))}catch{p("Something went wrong!")}};return o.useEffect(()=>{m&&(async()=>{var h;try{const r=await F(m);c(r.data),I(((h=r==null?void 0:r.data)==null?void 0:h.imageUrl)||j)}catch{p("Something went wrong!")}})()},[m]),o.useEffect(()=>{},[U,P]),o.useEffect(()=>{},[k,A,B]),o.useEffect(()=>{},[t]),e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"pageTile pageTitleSpace",children:m?"Update Item":"Add Item"}),e.jsx("div",{className:"addItemPage",children:e.jsx(L,{children:e.jsx(L.Body,{children:e.jsxs(s,{onSubmit:d(T),children:[e.jsx(g,{children:e.jsx(n,{className:"img d-flex justify-content-center",children:e.jsxs("div",{className:"h-100 position-relative imgWidth imgContainer",children:[e.jsx(z,{className:"h-100 imgWidth",src:j,roundedCircle:!0}),e.jsx(K,{icon:$,className:"editIcon",onClick:()=>{D()}}),e.jsx("input",{type:"file",ref:u,className:"fileselection",onChange:i=>M(i)})]})})}),e.jsxs("div",{className:"itemDetails",children:[e.jsx(g,{children:e.jsxs(n,{children:[e.jsx(s.Label,{className:"fromLabel",children:"Item Name"}),e.jsx(s.Control,{type:"text",placeholder:"Item Name",...l("itemName",{required:!0})}),(a==null?void 0:a.itemName)&&e.jsx("p",{className:"errorlabel",children:N("Item Name",a==null?void 0:a.itemName.type)})]})}),e.jsxs(g,{children:[e.jsxs(n,{children:[e.jsx(s.Label,{className:"fromLabel",children:"Price"}),e.jsx(s.Control,{type:"text",placeholder:"Price",maxLength:5,...l("itemPrice",{required:!0,pattern:{value:/^[0-9]*$/,message:"Entered value does not match email format"}})}),(a==null?void 0:a.itemPrice)&&e.jsx("p",{className:"errorlabel",children:N("Item Price",a==null?void 0:a.itemPrice.type)})]}),e.jsxs(n,{children:[e.jsx(s.Label,{className:"fromLabel",children:"Quantity"}),e.jsxs(s.Select,{"aria-label":"Default select example",...l("itemQty",{required:!0}),children:[e.jsx("option",{value:"2Kg",children:"2KG"}),e.jsx("option",{value:"1Kg",children:"1KG"}),e.jsx("option",{value:"500 gms",children:"500 Grams"})]})]})]}),e.jsxs(g,{children:[e.jsxs(n,{children:[e.jsx(s.Label,{className:"fromLabel",children:"Type"}),e.jsxs(s.Select,{"aria-label":"Default select example",...l("itemType",{required:!0}),children:[e.jsx("option",{value:"Leg Piece",children:"Leg Piece"}),e.jsx("option",{value:"Wings",children:"Wings"}),e.jsx("option",{value:"liver",children:"Liver"}),e.jsx("option",{value:"Boneless",children:"Boneless"}),e.jsx("option",{value:"withBone",children:"With Bone"})]})]}),e.jsxs(n,{children:[e.jsx(s.Label,{className:"fromLabel",children:"Meat Type"}),e.jsxs(s.Select,{"aria-label":"Default select example",...l("meatType",{required:!0}),children:[e.jsx("option",{value:"Chicken",children:"Chicken"}),e.jsx("option",{value:"Mutton",children:"Mutton"}),e.jsx("option",{value:"Eggs",children:"Eggs"})]})]})]}),e.jsxs(g,{children:[e.jsxs(n,{children:[e.jsx(s.Label,{className:"fromLabel",children:"Availability"}),e.jsx("br",{}),e.jsx(s.Check,{inline:!0,label:"Available",type:"radio",id:"inline-radio-1",...l("globalItemStatus",{required:!0}),value:"1",checked:!t||t.globalItemStatus===!0,onChange:()=>{c(t?{...t,globalItemStatus:!0}:{globalItemStatus:!0})}}),e.jsx(s.Check,{inline:!0,label:"Out of stock",type:"radio",id:"inline-radio-2",...l("globalItemStatus",{required:!0}),value:"0",checked:(t==null?void 0:t.globalItemStatus)===!1,onChange:()=>{c(t?{...t,globalItemStatus:!1}:{globalItemStatus:!1}),console.log("change2")}})]}),e.jsx(n,{})]}),e.jsxs("div",{className:"d-flex justify-content-end actionbtn",children:[e.jsx(y,{variant:"outline-secondary",className:"elementSpace",onClick:()=>{x("/inventory")},children:"Cancel"}),e.jsx(y,{variant:"outline-primary",type:"submit",disabled:E,onClick:()=>{},children:m?"Update":"Add"})]})]})]})})})})]})};export{ae as default};
