import{r as C,a as he,j as t,c as fe,n as me,o as pe,g as ge,e as ye,f as xe,F as ne,b as ae,s as ie}from"./index-C2SKbKF2.js";import{F as te,j as $e,k as je,l as Oe}from"./index-D2NHOHpo.js";import{T as ve}from"./Table-BI9_BJNJ.js";import{C as ce}from"./Card-DBpZkeQ1.js";import{u as Se,a as Ne}from"./branchesEndPoint-Cq5hCu-n.js";import{U as Me}from"./userTypeHook-dCkXHKo2.js";import{F as q}from"./appInterfaces-PvTAME0U.js";const ue=C.forwardRef(({bsPrefix:l,bg:f="primary",pill:w=!1,text:N,className:_,as:F="span",...M},D)=>{const I=he(l,"badge");return t.jsx(F,{ref:D,...M,className:fe(_,I,w&&"rounded-pill",N&&`text-${N}`,f&&`bg-${f}`)})});ue.displayName="Badge";const De=me.injectEndpoints({endpoints:l=>({getAllOrders:l.query({query:()=>"orders/getAllOrders",providesTags:["getAllOrders"]}),getOrderById:l.query({query:f=>`orders/getOrdersByUserId?orderId=${f}`}),updateOrderTranfer:l.mutation({query:f=>({url:`orders/updateOrder?orderId=${f.id}`,method:"POST",body:{franchiseId:f.franchiseId}})}),assignOrder:l.mutation({query:f=>(console.log("body",f),{url:`orders/updateOrder?orderId=${f.id}`,method:"POST",body:{deliveryAgentId:f.deliveryAgentId}})}),getOrderbyFranchise:l.query({query:f=>({url:`orders/ordersByQuery?franchiseId=${f.franchiseId}`,method:"GET"})})})}),{useLazyGetAllOrdersQuery:Ie,useGetOrderByIdQuery:ze,useUpdateOrderTranferMutation:be,useLazyGetOrderbyFranchiseQuery:we,useAssignOrderMutation:Ae}=De;var se=(l=>(l.In_Progress="In Process",l.Success="Success",l.Canceled="Canceled",l))(se||{}),de=(l=>(l.In_Progress="In Process",l.Success="SUCCESS",l))(de||{}),W=(l=>(l.Order="Order",l.Payment="Payment",l))(W||{});const Te=(l,f)=>{switch(l){case W.Order:{if(f===se.Success)return"OrederCompleted";if(f===se.Canceled)return"OrderCanceled";break}case W.Payment:return f===de.Success?"OrederCompleted":"";default:return!1}},le=({label:l,status:f,type:w})=>t.jsxs(t.Fragment,{children:[l&&t.jsxs(ue,{className:`align-middle text-capitalize OrderPending ${Te(w,f)}`,children:[t.jsx(te,{icon:$e,className:"statusIcon"}),l]}),!l&&"---"]});var oe={exports:{}};(function(l,f){(function(w,N){l.exports=N()})(pe,function(){var w=1e3,N=6e4,_=36e5,F="millisecond",M="second",D="minute",I="hour",j="day",P="week",O="month",Q="quarter",A="year",E="date",V="Invalid Date",K=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,X=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,H={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(a){var r=["th","st","nd","rd"],e=a%100;return"["+a+(r[(e-20)%10]||r[e]||r[0])+"]"}},J=function(a,r,e){var n=String(a);return!n||n.length>=r?a:""+Array(r+1-n.length).join(e)+a},re={s:J,z:function(a){var r=-a.utcOffset(),e=Math.abs(r),n=Math.floor(e/60),s=e%60;return(r<=0?"+":"-")+J(n,2,"0")+":"+J(s,2,"0")},m:function a(r,e){if(r.date()<e.date())return-a(e,r);var n=12*(e.year()-r.year())+(e.month()-r.month()),s=r.clone().add(n,O),i=e-s<0,c=r.clone().add(n+(i?-1:1),O);return+(-(n+(e-s)/(i?s-c:c-s))||0)},a:function(a){return a<0?Math.ceil(a)||0:Math.floor(a)},p:function(a){return{M:O,y:A,w:P,d:j,D:E,h:I,m:D,s:M,ms:F,Q}[a]||String(a||"").toLowerCase().replace(/s$/,"")},u:function(a){return a===void 0}},v="en",m={};m[v]=H;var Z="$isDayjsObject",U=function(a){return a instanceof k||!(!a||!a[Z])},S=function a(r,e,n){var s;if(!r)return v;if(typeof r=="string"){var i=r.toLowerCase();m[i]&&(s=i),e&&(m[i]=e,s=i);var c=r.split("-");if(!s&&c.length>1)return a(c[0])}else{var d=r.name;m[d]=r,s=d}return!n&&s&&(v=s),s||!n&&v},p=function(a,r){if(U(a))return a.clone();var e=typeof r=="object"?r:{};return e.date=a,e.args=arguments,new k(e)},u=re;u.l=S,u.i=U,u.w=function(a,r){return p(a,{locale:r.$L,utc:r.$u,x:r.$x,$offset:r.$offset})};var k=function(){function a(e){this.$L=S(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[Z]=!0}var r=a.prototype;return r.parse=function(e){this.$d=function(n){var s=n.date,i=n.utc;if(s===null)return new Date(NaN);if(u.u(s))return new Date;if(s instanceof Date)return new Date(s);if(typeof s=="string"&&!/Z$/i.test(s)){var c=s.match(K);if(c){var d=c[2]-1||0,h=(c[7]||"0").substring(0,3);return i?new Date(Date.UTC(c[1],d,c[3]||1,c[4]||0,c[5]||0,c[6]||0,h)):new Date(c[1],d,c[3]||1,c[4]||0,c[5]||0,c[6]||0,h)}}return new Date(s)}(e),this.init()},r.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},r.$utils=function(){return u},r.isValid=function(){return this.$d.toString()!==V},r.isSame=function(e,n){var s=p(e);return this.startOf(n)<=s&&s<=this.endOf(n)},r.isAfter=function(e,n){return p(e)<this.startOf(n)},r.isBefore=function(e,n){return this.endOf(n)<p(e)},r.$g=function(e,n,s){return u.u(e)?this[n]:this.set(s,e)},r.unix=function(){return Math.floor(this.valueOf()/1e3)},r.valueOf=function(){return this.$d.getTime()},r.startOf=function(e,n){var s=this,i=!!u.u(n)||n,c=u.p(e),d=function(Y,$){var L=u.w(s.$u?Date.UTC(s.$y,$,Y):new Date(s.$y,$,Y),s);return i?L:L.endOf(j)},h=function(Y,$){return u.w(s.toDate()[Y].apply(s.toDate("s"),(i?[0,0,0,0]:[23,59,59,999]).slice($)),s)},g=this.$W,y=this.$M,x=this.$D,T="set"+(this.$u?"UTC":"");switch(c){case A:return i?d(1,0):d(31,11);case O:return i?d(1,y):d(0,y+1);case P:var o=this.$locale().weekStart||0,b=(g<o?g+7:g)-o;return d(i?x-b:x+(6-b),y);case j:case E:return h(T+"Hours",0);case I:return h(T+"Minutes",1);case D:return h(T+"Seconds",2);case M:return h(T+"Milliseconds",3);default:return this.clone()}},r.endOf=function(e){return this.startOf(e,!1)},r.$set=function(e,n){var s,i=u.p(e),c="set"+(this.$u?"UTC":""),d=(s={},s[j]=c+"Date",s[E]=c+"Date",s[O]=c+"Month",s[A]=c+"FullYear",s[I]=c+"Hours",s[D]=c+"Minutes",s[M]=c+"Seconds",s[F]=c+"Milliseconds",s)[i],h=i===j?this.$D+(n-this.$W):n;if(i===O||i===A){var g=this.clone().set(E,1);g.$d[d](h),g.init(),this.$d=g.set(E,Math.min(this.$D,g.daysInMonth())).$d}else d&&this.$d[d](h);return this.init(),this},r.set=function(e,n){return this.clone().$set(e,n)},r.get=function(e){return this[u.p(e)]()},r.add=function(e,n){var s,i=this;e=Number(e);var c=u.p(n),d=function(y){var x=p(i);return u.w(x.date(x.date()+Math.round(y*e)),i)};if(c===O)return this.set(O,this.$M+e);if(c===A)return this.set(A,this.$y+e);if(c===j)return d(1);if(c===P)return d(7);var h=(s={},s[D]=N,s[I]=_,s[M]=w,s)[c]||1,g=this.$d.getTime()+e*h;return u.w(g,this)},r.subtract=function(e,n){return this.add(-1*e,n)},r.format=function(e){var n=this,s=this.$locale();if(!this.isValid())return s.invalidDate||V;var i=e||"YYYY-MM-DDTHH:mm:ssZ",c=u.z(this),d=this.$H,h=this.$m,g=this.$M,y=s.weekdays,x=s.months,T=s.meridiem,o=function($,L,G,R){return $&&($[L]||$(n,i))||G[L].slice(0,R)},b=function($){return u.s(d%12||12,$,"0")},Y=T||function($,L,G){var R=$<12?"AM":"PM";return G?R.toLowerCase():R};return i.replace(X,function($,L){return L||function(G){switch(G){case"YY":return String(n.$y).slice(-2);case"YYYY":return u.s(n.$y,4,"0");case"M":return g+1;case"MM":return u.s(g+1,2,"0");case"MMM":return o(s.monthsShort,g,x,3);case"MMMM":return o(x,g);case"D":return n.$D;case"DD":return u.s(n.$D,2,"0");case"d":return String(n.$W);case"dd":return o(s.weekdaysMin,n.$W,y,2);case"ddd":return o(s.weekdaysShort,n.$W,y,3);case"dddd":return y[n.$W];case"H":return String(d);case"HH":return u.s(d,2,"0");case"h":return b(1);case"hh":return b(2);case"a":return Y(d,h,!0);case"A":return Y(d,h,!1);case"m":return String(h);case"mm":return u.s(h,2,"0");case"s":return String(n.$s);case"ss":return u.s(n.$s,2,"0");case"SSS":return u.s(n.$ms,3,"0");case"Z":return c}return null}($)||c.replace(":","")})},r.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},r.diff=function(e,n,s){var i,c=this,d=u.p(n),h=p(e),g=(h.utcOffset()-this.utcOffset())*N,y=this-h,x=function(){return u.m(c,h)};switch(d){case A:i=x()/12;break;case O:i=x();break;case Q:i=x()/3;break;case P:i=(y-g)/6048e5;break;case j:i=(y-g)/864e5;break;case I:i=y/_;break;case D:i=y/N;break;case M:i=y/w;break;default:i=y}return s?i:u.a(i)},r.daysInMonth=function(){return this.endOf(O).$D},r.$locale=function(){return m[this.$L]},r.locale=function(e,n){if(!e)return this.$L;var s=this.clone(),i=S(e,n,!0);return i&&(s.$L=i),s},r.clone=function(){return u.w(this.$d,this)},r.toDate=function(){return new Date(this.valueOf())},r.toJSON=function(){return this.isValid()?this.toISOString():null},r.toISOString=function(){return this.$d.toISOString()},r.toString=function(){return this.$d.toUTCString()},a}(),z=k.prototype;return p.prototype=z,[["$ms",F],["$s",M],["$m",D],["$H",I],["$W",j],["$M",O],["$y",A],["$D",E]].forEach(function(a){z[a[1]]=function(r){return this.$g(r,a[0],a[1])}}),p.extend=function(a,r){return a.$i||(a(r,k,p),a.$i=!0),p},p.locale=S,p.isDayjs=U,p.unix=function(a){return p(1e3*a)},p.en=m[v],p.Ls=m,p.p={},p})})(oe);var Ce=oe.exports;const Ee=ge(Ce),ee=l=>l===q.FRANCHISE,B=l=>l===q.ADMIN,Le=l=>l===q.DELIVERYAGENTS,Be=()=>{const l=ye(),[f,{data:w,isLoading:N,error:_}]=Ie(),[F,{data:M,isLoading:D,error:I}]=we(),{data:j,isLoading:P,isError:O}=Se(void 0),[Q,{data:A,isLoading:E,isError:V}]=be(),[K]=Ae(),[X,{data:H,isLoading:J,isError:re}]=Ne(),v=xe(e=>{var n;return(n=e==null?void 0:e.userInfoSlice)==null?void 0:n.userInfo}),m=Me(),[Z,U]=C.useState(null),[S,p]=C.useState(null),[u,k]=C.useState(null),z=()=>{l("orderDetails")},a=async e=>{try{const n=await Q(e);ie("Order transfered succesfully")}catch(n){console.log("e",n)}},r=async e=>{try{const n=await K(e);console.log("assignOrderToDeliveryAgent",n,e),ie("Order Assigned succesfully")}catch(n){console.log("e",n)}};return C.useEffect(()=>{m===q.FRANCHISE&&(F({franchiseId:v==null?void 0:v.id}),X({franchiseId:v==null?void 0:v.id,userType:q.DELIVERYAGENTS})),m===q.ADMIN&&f(void 0)},[m]),C.useEffect(()=>{U(N),p(w),k(_)},[w,,N,_]),C.useEffect(()=>{U(D),p(M),k(I)},[M,,D,I]),C.useEffect(()=>{},[A,E,V]),C.useEffect(()=>{},[P,O]),t.jsx(t.Fragment,{children:t.jsx("div",{className:"Orderpage",children:t.jsx(ce,{className:"h-100",children:t.jsx(ce.Body,{children:t.jsxs(ve,{hover:!0,children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:t.jsx("p",{className:"tableTitle",children:"#"})}),t.jsx("th",{children:t.jsx("p",{className:"tableTitle",children:"Order"})}),t.jsx("th",{children:t.jsx("p",{className:"tableTitle",children:"Date"})}),t.jsx("th",{children:t.jsx("p",{className:"tableTitle",children:"Customer Name"})}),t.jsx("th",{children:t.jsx("p",{className:"tableTitle",children:"Order Status"})}),t.jsx("th",{children:t.jsx("p",{className:"tableTitle",children:"Payment Status"})}),t.jsx("th",{children:t.jsx("p",{className:"tableTitle",children:"Phone"})}),t.jsx("th",{children:t.jsx("p",{className:"tableTitle",children:"Address"})}),B(m)&&t.jsx("th",{children:t.jsx("p",{className:"tableTitle",children:"Transfer"})}),ee(m)&&t.jsx("th",{children:t.jsx("p",{className:"tableTitle",children:"Assign To"})}),t.jsx("th",{children:t.jsx("p",{className:"tableTitle",children:"Actions"})})]})}),t.jsxs("tbody",{children:[u&&t.jsx("tr",{children:t.jsx("td",{colSpan:B(m)?10:9,className:"pageStatus",children:t.jsx("p",{className:"text-center",children:"Something went wrong!"})})}),Z&&t.jsx("tr",{children:t.jsx("td",{colSpan:B(m)?10:9,className:"pageStatus",children:t.jsx("p",{className:"text-center",children:"Loading..."})})}),(S==null?void 0:S.length)===0&&t.jsx("tr",{children:t.jsx("td",{colSpan:B(m)?10:9,className:"pageStatus",children:t.jsx("p",{className:"text-center",children:"No Data Found"})})}),S&&(S==null?void 0:S.map((e,n)=>{var s,i,c,d,h,g,y,x,T;return t.jsxs("tr",{children:[t.jsx("td",{className:"tableItem ",children:n+1}),t.jsx("td",{className:"tableItem curserPointer",onClick:()=>{z()},children:t.jsx("p",{className:"Orderpage-id",children:`#${e==null?void 0:e.id}`})}),t.jsxs("td",{className:"tableItem text-nowrap",children:[Ee(e==null?void 0:e.date).format("MMMM D, YYYY h:mm A")," "]}),t.jsx("td",{className:"tableItem text-capitalize",children:((s=e.userId)==null?void 0:s.name)||"---"}),t.jsx("td",{className:"tableItem text-capitalize",children:t.jsx(le,{label:e==null?void 0:e.orderStatus,status:e==null?void 0:e.orderStatus,type:W.Order})}),t.jsx("td",{className:"tableItem text-capitalize",children:t.jsx(le,{label:(i=e==null?void 0:e.paymentStatus)==null?void 0:i.toLocaleLowerCase(),status:e==null?void 0:e.paymentStatus,type:W.Payment})}),t.jsx("td",{className:"tableItem",children:((c=e==null?void 0:e.userId)==null?void 0:c.primaryNumber)||"---"}),t.jsxs("td",{className:"tableItem",children:[(h=(d=e==null?void 0:e.userId)==null?void 0:d.primaryAddress)==null?void 0:h.name,", ",(y=(g=e==null?void 0:e.userId)==null?void 0:g.primaryAddress)==null?void 0:y.houseNo,", ",(T=(x=e==null?void 0:e.userId)==null?void 0:x.primaryAddress)==null?void 0:T.streetName]}),B(m)&&t.jsx("td",{className:"tableItem",children:t.jsx(ne.Select,{"aria-label":"Order Transfer",onChange:o=>{var b;a({id:e.id,franchiseId:(b=o==null?void 0:o.target)==null?void 0:b.value})},children:j&&(j==null?void 0:j.map(o=>t.jsx("option",{value:o._id,selected:(e==null?void 0:e.franchiseId)===o._id,children:o==null?void 0:o.name})))})}),ee(m)&&t.jsx("th",{className:"tableItem",children:t.jsx(ne.Select,{"aria-label":"Order Transfer",onChange:o=>{var b;r({id:e.id,deliveryAgentId:(b=o==null?void 0:o.target)==null?void 0:b.value})},children:H&&(H==null?void 0:H.map(o=>t.jsx("option",{value:o.id,selected:(e==null?void 0:e.deliveryAgentId)===o.id,children:o==null?void 0:o.name})))})}),t.jsxs("td",{className:"text-nowrap",children:[(B(m)||ee(m))&&t.jsxs(t.Fragment,{children:[t.jsx(te,{icon:je,className:"Orderpage-actions Orderpage-eye",onClick:()=>{z()}})," ",t.jsx(te,{icon:Oe,className:"Orderpage-actions",onClick:()=>{z()}})," "]}),Le(m)&&t.jsxs(t.Fragment,{children:[t.jsx(ae,{variant:"outline-primary",className:"elementSpace",children:"Accept"}),t.jsx(ae,{variant:"outline-secondary",children:"Cancel"})]})]})]})}))]})]})})})})})};export{Be as default};
